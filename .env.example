# 后端环境变量配置示例
# 复制此文件为 .env 并填入实际值

# DeepSeek API配置（必需）
DEEPSEEK_API_KEY=your_deepseek_api_key_here
DEEPSEEK_API_URL=https://api.deepseek.com

# MongoDB 副本集与安全配置
MONGO_ROOT_USER=storyapp_root
MONGO_ROOT_PASS=StoryAppRoot!234
MONGO_APP_USER=storyapp_app
MONGO_APP_PASS=StoryAppApp!234
MONGO_BACKUP_USER=storyapp_backup
MONGO_BACKUP_PASS=StoryAppBackup!234
MONGO_REPLICA_SET=storyapp-rs
MONGO_MAINTENANCE_DB=admin
MONGODB_URI=mongodb://storyapp_app:StoryAppApp!234@storyapp-mongo-primary:27017,storyapp-mongo-secondary:27017/storyapp?replicaSet=storyapp-rs&authSource=admin&retryWrites=true&w=majority&readPreference=primaryPreferred&tls=true
MONGODB_DB_NAME=storyapp
MONGODB_TLS_CA_FILE=./config/mongo/tls/ca.pem
# 可选：若启用客户端证书或自定义路径
# MONGODB_TLS_CERT_FILE=./config/mongo/tls/client.pem

# MongoDB 连接池与超时（可按需调整）
MONGODB_MAX_POOL_SIZE=50
MONGODB_MIN_POOL_SIZE=5
MONGODB_MAX_IDLE_TIME_MS=30000
MONGODB_CONNECT_TIMEOUT_MS=20000
MONGODB_SOCKET_TIMEOUT_MS=60000
MONGODB_SERVER_SELECTION_TIMEOUT_MS=30000
MONGODB_WAIT_QUEUE_TIMEOUT_MS=5000
MONGODB_RETRY_WRITES=true
MONGODB_READ_PREFERENCE=primaryPreferred

# 服务器配置
PORT=5000
NODE_ENV=development
FRONTEND_URL=http://localhost:3000

# 安全配置
RATE_LIMIT_WINDOW_MS=900000  # 15分钟
RATE_LIMIT_MAX_REQUESTS=100   # 每个IP最大请求数

# 日志记录配置
ENABLE_DETAILED_LOGGING=true
ENABLE_FILE_LOGGING=false
ENABLE_DB_LOGGING=true
LOG_LEVEL=info
LOG_RETENTION_DAYS=30

# 性能监控配置
ENABLE_PERFORMANCE_MONITORING=true
PERFORMANCE_SAMPLE_RATE=1.0

# 语音合成配置
TTS_PROVIDER=mock
TTS_CACHE_TTL=300
TTS_RATE_LIMIT_WINDOW=60000
TTS_RATE_LIMIT_MAX=10
TTS_AUDIO_BASE_URL=http://localhost:5001/static/tts
TTS_AUDIO_OUTPUT_DIR=storage/tts
TTS_AUDIO_DOWNLOAD_TIMEOUT_MS=20000
# 测试环境相关：默认禁止 HTTP 下载，可按需打开
# TTS_TEST_ALLOW_HTTP_DOWNLOAD=1

# 阿里云语音合成凭证（上线前替换为实际值）
# ALICLOUD_TTS_APP_KEY=
# ALICLOUD_TTS_ACCESS_KEY_ID=
# ALICLOUD_TTS_ACCESS_KEY_SECRET=

# 科大讯飞语音合成凭证（上线前替换为实际值）
# IFLYTEK_TTS_APP_ID=
# IFLYTEK_TTS_API_KEY=
# IFLYTEK_TTS_API_SECRET=
# IFLYTEK_TTS_API_HOST=api-dx.xf-yun.com
# IFLYTEK_TTS_POLL_INTERVAL_MS=2000
# IFLYTEK_TTS_POLL_TIMEOUT_MS=120000
# IFLYTEK_TTS_REQUEST_TIMEOUT_MS=15000
# 测试环境使用假轮询结果
# IFLYTEK_TTS_TEST_FAKE=1
# TTS_TEST_FAKE_AUDIO_URL=http://localhost/fake.mp3
